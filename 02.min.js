(()=>{let e=Math.random,i=a,r=i.getContext("2d"),h=i.cloneNode(),n=h.getContext("2d"),o=[],l=[];function s(){i.width=h.width=innerWidth,i.height=h.height=innerHeight,i.style.filter="saturate(3)",o=[];for(let t=0;t<80;t++)o.push({x:e()*i.width,y:e()*i.height,vx:0,vy:0,r:.001*i.height+25*e(),setpoint:e()*Math.PI*2,error:.1,gain:.9+.8*e(),delayBuffer:[],emissionPower:1+5*e(),hue:140+80*e()})}window.addEventListener("resize",s),s(),function a(){n.fillStyle="rgba(120, 19, 93, 0.01)",n.fillRect(0,0,h.width,h.height);for(let t=l.length-1;t>=0;t--){let e=l[t];if(e.x+=e.vx,e.y+=e.vy,e.a-=.1,e.a<=0)l.splice(t,1);else{n.fillStyle=e.err>0?`rgba(125,115,0,${e.a})`:`rgba(38,43,226,${e.a})`;let t=Math.max(0,e.err/Math.PI),i=e.err>0?e.r*(1+2*t):e.r;n.beginPath(),n.arc(e.x,e.y,i,0,2*Math.PI),n.fill()}}o.forEach((t,a)=>{let r=a>0?o[a-1]:null,h=0;r?(h=r.setpoint-t.setpoint,h=(h+Math.PI)%(2*Math.PI)-Math.PI,t.delayBuffer.push(h),t.delayBuffer.length>30&&(h=t.delayBuffer.shift()),t.setpoint+=t.gain*h):t.setpoint+=15*(e()-.5)*Math.PI;let s=2+1*e()*t.emissionPower*20.5;t.vx=Math.cos(t.setpoint)*s,t.vy=Math.sin(t.setpoint)*s,t.x+=.53*t.vx,t.y+=.53*t.vy,t.x<0&&(t.x=i.width),t.x>i.width&&(t.x=0),t.y<0&&(t.y=i.height),t.y>i.height&&(t.y=0),e()<.02&&function(t,i){let a=t.setpoint,r=t.emissionPower;l.push({x:t.x,y:t.y,vx:Math.cos(a)*r,vy:Math.sin(a)*r,r:1+3*e(),a:1,err:i})}(t,h);let d=.3+.1*(1-a/79),y=n.createRadialGradient(t.x,t.y,.5*t.r,t.x,t.y,t.r);y.addColorStop(0,`rgba(35,215,100,${d})`),y.addColorStop(.8,`rgba(138,53,226,${d})`),n.fillStyle=y,n.beginPath(),n.arc(t.x,t.y,t.r,0,2*Math.PI),n.fill()}),r.drawImage(h,0,0),requestAnimationFrame(a),t.textContent=(Date.now()/1e3).toFixed(3)}()})()