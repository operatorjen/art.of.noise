(()=>{(()=>{let i=Math.random,M=a,u=a.getContext("2d"),r=a.cloneNode(),h=r.getContext("2d"),d=[],g=200;function c(){return{x:i()*a.width,y:i()*a.height,vx:0,vy:0,r:a.height*.001+15*i(),setpoint:i()*Math.PI*2,error:.5,gain:10.9+.8*i(),delayBuffer:[],emissionPower:1+5*i(),hue:240+20*i()}}function w(){a.width=r.width=innerWidth,a.height=r.height=innerHeight,a.style.filter="saturate(2)",d=[];for(let o=0;o<g;o++)d.push(c())}(()=>{function o(){h.fillStyle=`rgba(22, 178, 174, ${i()*.03-.005+.005})`,h.fillRect(0,0,r.width,r.height),d.forEach((e,f)=>{let y=f>0?d[f-1]:null,l=0;y?(l=y.setpoint-e.setpoint,l=(l+Math.PI)%(2*Math.PI)-Math.PI,e.delayBuffer.push(l),e.delayBuffer.length>30&&(l=e.delayBuffer.shift()),e.setpoint+=e.gain*l):e.setpoint+=(i()-.5)*5*Math.PI;let x=12+1*i()*e.emissionPower*10.5;e.vx=(i()<.9?Math.sin(e.setpoint):Math.cos(e.setpoint))*x,e.vy=Math.sin(e.setpoint)*x,e.x+=e.vx*.43*i(),e.y+=e.vy*.3*i(),e.x<0&&(e.x=a.width),e.x>a.width&&(e.x=0),e.y<0&&(e.y=a.height),e.y>a.height&&(e.y=0);let p=.08+.4*(1-f/(g-1)),s=h.createRadialGradient(e.x,e.y,e.r*5*i(),e.x,e.y,e.r);s.addColorStop(0,`rgba(235,215,30,${p})`),s.addColorStop(1,`rgba(238,153,226,${p})`),h.fillStyle=s,h.beginPath(),h.arc(e.x,e.y,e.r,0,Math.PI*2),h.fill()}),u.drawImage(r,0,0),window.rafId=requestAnimationFrame(o),t.textContent=(Date.now()/1e3).toFixed(3)}registerExhibit(w,o)})()})();})();
