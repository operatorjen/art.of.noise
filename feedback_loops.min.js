(()=>{let e=Math.random,i=a,r=i.getContext("2d"),n=(t,i.cloneNode()),h=n.getContext("2d"),o=[],l=[];function s(){i.width=n.width=innerWidth,i.height=n.height=innerHeight,i.style.filter="saturate(3.0)",o=[];for(let t=0;t<200;t++)o.push({x:e()*i.width,y:e()*i.height,vx:0,vy:0,r:.01*i.height+15*e(),setpoint:e()*Math.PI*2,error:0,gain:.5+.8*e(),delayBuffer:[],emissionPower:1+5*e(),hue:200+100*e()})}window.addEventListener("resize",s),s(),function a(){h.fillStyle="rgba(26, 131, 131, 0.01)",h.fillRect(0,0,n.width,n.height);for(let t=l.length-1;t>=0;t--){let e=l[t];if(e.x+=e.vx,e.y+=e.vy,e.a-=.08,e.a<=0)l.splice(t,1);else{h.fillStyle=e.err>0?`rgba(225,215,0,${e.a})`:`rgba(138,43,226,${e.a})`;let t=Math.max(0,e.err/Math.PI),i=e.err>0?e.r*(1+2*t):e.r;h.beginPath(),h.arc(e.x,e.y,i,0,2*Math.PI),h.fill()}}o.forEach((t,a)=>{let r=a>0?o[a-1]:null,n=0;r?(n=r.setpoint-t.setpoint,n=(n+Math.PI)%(2*Math.PI)-Math.PI,t.delayBuffer.push(n),t.delayBuffer.length>30&&(n=t.delayBuffer.shift()),t.setpoint+=t.gain*n):t.setpoint+=10.7*(e()-.5);let s=2+5*e()*t.emissionPower*1.8;t.vx=Math.cos(t.setpoint)*s,t.vy=Math.sin(t.setpoint)*s,t.x+=.3*t.vx,t.y+=.3*t.vy,t.x<0&&(t.x=i.width),t.x>i.width&&(t.x=0),t.y<0&&(t.y=i.height),t.y>i.height&&(t.y=0),e()<.02&&function(t,i){let a=t.setpoint,r=t.emissionPower;l.push({x:t.x,y:t.y,vx:Math.cos(a)*r,vy:Math.sin(a)*r,r:1+5*e(),a:1,err:i})}(t,n);let d=.03+.3*(1-a/199),y=h.createRadialGradient(t.x,t.y,.5*t.r,t.x,t.y,t.r);y.addColorStop(0,`rgba(255,215,0,${d})`),y.addColorStop(1,`rgba(138,43,226,${d})`),h.fillStyle=y,h.beginPath(),h.arc(t.x,t.y,t.r,0,2*Math.PI),h.fill()}),r.drawImage(n,0,0),requestAnimationFrame(a),t.textContent=(Date.now()/1e3).toFixed(3)}()})()